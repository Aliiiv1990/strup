{% extends "base.html" %}

{% block title %}{{ form_title }} - پلتفرم واتساپ{% endblock %}

{% block content %}
<h1>{{ form_title }}</h1>
{% if list_id %}
    <p>افزودن مخاطب به لیست: <strong>{{ list_name }}</strong></p>
{% endif %}

<form method="POST" action="{{ form_action_url }}">
    {% if list_id %}
        <input type="hidden" name="list_id" value="{{ list_id }}">
    {% endif %}
    <div class="form-group">
        <label for="contact_name">نام مخاطب:</label>
        <input type="text" id="contact_name" name="contact_name" value="{{ contact.name if contact else '' }}" required>
    </div>
    <div class="form-group">
        <label for="whatsapp_id">شناسه واتساپ (شماره موبایل با کد کشور):</label>
        <input type="tel" id="whatsapp_id" name="whatsapp_id" value="{{ contact.whatsapp_id if contact else '' }}" placeholder="مثال: 989123456789" required>
    </div>
    <div class="form-group">
        <label for="custom_fields">فیلدهای سفارشی (فرمت JSON):</label>
        <textarea id="custom_fields" name="custom_fields" rows="4" placeholder='مثال: {"شهر": "تهران", "کد_مشتری": "C123"}\n(اختیاری)'>{{ contact.custom_fields_json if contact and contact.custom_fields_json else '{}' }}</textarea>
        <p class="help-text">برای مثال: <code>{"شهر": "تهران", "کد_مشتری": "C123"}</code> یا خالی بگذارید.</p>
    </div>
    <div class="form-actions">
        <button type="submit">ذخیره مخاطب</button>
        {% if list_id %}
            <a href="{{ url_for('contact_list_detail_route', list_id=list_id) }}">انصراف</a>
        {% else %}
            <a href="{{ url_for('contact_lists_route') }}">انصراف</a>
        {% endif %}
    </div>
</form>
{% endblock %}
