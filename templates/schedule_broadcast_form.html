{% extends "base.html" %}

{% block title %}زمان‌بندی ارسال گروهی جدید - پلتفرم واتساپ{% endblock %}

{% block content %}
<h1>زمان‌بندی ارسال گروهی جدید</h1>
<form method="POST" action="{{ url_for('create_broadcast_route') }}">
    <div class="form-group">
        <label for="broadcast_name">نام ارسال گروهی (اختیاری، برای یادآوری شما):</label>
        <input type="text" id="broadcast_name" name="broadcast_name" placeholder="مثلا: کمپین تخفیف نوروزی">
    </div>

    <div class="form-group">
        <label for="message_content_id">قالب پیام:</label>
        <select name="message_content_id" id="message_content_id" required>
            <option value="">-- انتخاب قالب پیام --</option>
            {% for msg_template in available_message_templates %}
            <option value="{{ msg_template.id }}">{{ msg_template.name }} ({{ msg_template.body_snippet }})</option>
            {% endfor %}
        </select>
        <p class="help-text">برای ایجاد قالب جدید، به بخش مدیریت محتوای پیام مراجعه کنید (لینک در آینده).</p>
    </div>

    <div class="form-group">
        <label for="contact_list_ids">لیست(های) مخاطبین هدف:</label>
        <select name="contact_list_ids" id="contact_list_ids" multiple required size="5">
             {% for cl_list in available_contact_lists %}
            <option value="{{ cl_list.id }}">{{ cl_list.name }} ({{ cl_list.contact_count }} مخاطب)</option>
            {% endfor %}
        </select>
        <p class="help-text">برای انتخاب چند لیست، کلید Ctrl (یا Cmd در مک) را نگه دارید و کلیک کنید.</p>
    </div>

    <div class="form-group">
        <label for="scheduled_time">زمان ارسال:</label>
        <input type="datetime-local" name="scheduled_time" id="scheduled_time" required>
        <p class="help-text">زمان ارسال پیام را با دقت انتخاب کنید.</p>
    </div>
    
    <div class="form-group">
        <label for="personalization_placeholders">مقادیر شخصی‌سازی کمپین (فرمت JSON، اختیاری):</label>
        <textarea id="personalization_placeholders" name="personalization_placeholders" rows="3" placeholder='مثال: {"کد_تخفیف": "BAHAR1403", "نام_کمپین": "جشنواره بهاری"}'></textarea>
        <p class="help-text">این مقادیر می‌توانند در متن پیام با فرمت <code>{{broadcast_کد_تخفیف}}</code> استفاده شوند.</p>
    </div>

    <div class="form-actions">
        <button type="submit">زمان‌بندی ارسال</button>
        <a href="{{ url_for('broadcasts_route') }}">انصراف</a>
    </div>
</form>
{% endblock %}
